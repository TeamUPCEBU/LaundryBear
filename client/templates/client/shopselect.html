{% extends 'client/base.html' %}
{% load staticfiles %}

{% block stylesheets %}
<link rel="stylesheet" href="{% static "client/css/selectshopcontrol.css" %}" />
<link rel="stylesheet" href="{% static "client/css/viewcontrol.css" %}" />
<link rel="stylesheet" href="{% static "LaundryBear/css/normalize.css" %}" />
<link rel="stylesheet" href="{% static "LaundryBear/reveal/reveal.css" %}" />
{% endblock %}

{% block title %}Laundry Bear | Request {% endblock %}

{% block body %}

<div class="row">
  <div class="container shop-header green lighten-5 z-depth-2" style="padding-top: 5px; margin-top: 10px">
    <h3 style="text-align:center"> {{ shop.name }} </h3>
    <div class="row">
        <div class="center" >
            {% if shop.average_rating %}
            <h5>
              {{ shop.average_rating }} paws
              <div class="raty-rating" data-value="{{shop.average_rating}}"></div>
              <span>a total of {{ shop.raters }}
                {% if shop.raters == 1 %}
                review
                {% else %}
                reviews
                {% endif %}
              </span>
            </h5>
            {% else %}
            <h5>This shop has no paws yet.</h5>
            <span>Be the first to imprint <i class="fa fa-fw fa-paw"></i></span>
            {% endif %}
        </div>
        <div class="center">
            <p><strong>Location</strong> <br>{{ shop.location }} </p>
            <p><strong>Contact number </strong><br> {{ shop.contact_number}}</p>
            <p><strong>Days Open</strong><br> {{shop.days_open}}, {{ shop.hours_open }}</p>
            {% if shop.email %}
            <p><strong>Email</strong><br> {{ shop.email}} </p>
            {% else %} {% endif %}
        </div>
    </div>
  </div>
</div>
<br>
<br>
<div class="row">
  <div class="container center">
    <h5>Choose Service</h5>
    <div class="row">
      <div class="input-field s12">
        <select class="service-choices">
          <option value="" disabled selected>Choose your option</option>
          {% for price in service_list %}
          <option class="black" value="{{price.pk}}" data-price = "{{price.price}}"  data-description="{{price.service.description}}">{{price.service.name}}</option>
          {% endfor %}
        </select>
      </div>
      <!-- <div class="center">
        <button class="btn waves-effect waves-light pink lighteon-2 modal-trigger" data-target="serviceModal">Avail this Service</button>
      </div> -->
    </div>
  </div>
</div>

<div class="row">
  <div class="container">
    <h4 class="center">My Laundry Basket</h4>
    <h5 class="center nothing-label">Nothing in basket yet.</h5>
    <ul class="collapsible service-orders" data-collapsible="expandable">
    </ul>
  </div>
</div>
<div class="modal" id="serviceModal">
  <div class="modal-content">
      <div class="container">
        <div class="row">
          <h3></h3>
          <p id="servicePrice"></p>
          <p id="serviceDescription"></p>
          Number of clothes <input class="input-field num-clothes" type="number" min="1" value ="0"/>
        </div>
      </div>
  </div>
  <div class="modal-footer">
    <a href="#" class="modal-action modal-close waves-effect waves-light light-blue btn-flat add-to-basket">
      <span class="grey-text text-darken-4"><i class="material-icons" style="vertical-align:bottom">add_shopping_cart</i>Add to Basket
      </span>
    </a>
  </div>
</div>

<div class="modal" id="requestModal">
  <div class="modal-content">
    <div class="summary-headers">
      <h3 class="center">Summary</h3>
      <h5 class="center">{{ shop.name }}</h5>
      <div class="summary-container">
        <table class="summary-table centered striped">
          <thead>
            <tr>
              <th data-field="service">Service</th>
              <th data-field="items">No. of Items</th>
              <th data-field="eprice">Estimated Price</th>
            </tr>
          </thead>
          <tbody>

          </tbody>
        </table>
        <div class="row" style="margin-top: 15px">
<!--<<<<<< HEAD
          <div class="col offset-m2 offset-l2 offset-s1">
            <span>Subtotal: <i class="fa fa-fw fa-pesos"></i></span>
          </div>
        </div>
        <div class="row">
          <div class="col offset-m3 offset-l3 offset-s2">
            <span class="subtotal-value"></span>
          </div>
        </div>

        <div class="row" style="margin-top: 15px">
          <div class="col offset-m2 offset-l2 offset-s1">
            <span>Fees: <i class="fa fa-fw fa-pesos"></i></span>
          </div>
        </div>
        <div class="row">
          <div class="col offset-m3 offset-l3 offset-s2">
            <span>{{fees.service_charge}}</span>
            <span>{{fees.delivery_fee}}</span>
          </div>
        </div>
=======-->
          <div class="col offset-m2 offset-l2 l4 m4 s6">
            <span><b>Subtotal:</b></span>
          </div>
          <div class="l4 m4 s5">

          </div>
        </div>
        <div class="row">
          <div class="col offset-m3 offset-l3 offset-s1 l4 m4 s6">
            <span class="subtotal-value"></span>
          </div>
        </div>
        <div class="row">
          <div class="col offset-m2 offset-l2">
          <!--<span class="deli-date" value = "{{delivery_date}}">{{delivery_date}}</span>-->
          <b>Delivery Date: </b>
          <span><input type="date" min="{{ delivery_date }}"  value="{{ delivery_date }}" max="{{ delivery_date_max }}" name="delivery_date"></span>
          </div>
        </div>

        <div class="row" style="margin-top: 15px">
          <div class="col offset-m2 offset-l2 ">
            <span><b>Fees:</b> </span>
          </div>
        </div>
        <div class="row">
          <div class="col offset-m3 offset-l3 offset-s1">
            <span id="serviceCharge" data-service = "{{fees.service_charge}}" data-pk="{{ fees.pk }}">Service Charge: {{fees.service_charge}}</span><br>
            <span id="deliverFee" data-deliver = "{{fees.delivery_fee}}">Delivery Fee: {{fees.delivery_fee}}</span>
          </div>
        </div>
        <div class="row" style="margin-top: 15px">
          <div class="col offset-m2 offset-l2">
            <span style="font-size:1.5em" id="total-payment"></span><span style="font-size:1.5em" id="total_value"></span><br><br>
          </div>
        </div>
        <div class="row">
          <div class="col offset-m2 offset-l2">
            <span><b>Delivery Address: </b></span>
          </div>
        </div>
        <div class="row">
          <div class="col l12 m12 s12">
            <span>{{ address_form.building.label }}:{{ address_form.building }}</span>
            <span>{{ address_form.street.label }}:{{ address_form.street }}</span>
            <span>{{ address_form.barangay.label }}:{{ address_form.barangay }}</span>
            <span>{{ address_form.city.label }}:{{ address_form.city }}</span>
            <span>{{ address_form.province.label }}:{{ address_form.province }}</span>
          </div>
        </div>
        <div class="row">
        <button class="modal-action modal-close btn red waves-light waves-effect">Back</button>
          <a id="confirm" class="btn blue waves-light waves-effect">Order</a>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row">
    <div class="large-12 columns" align="center">
        <a href="{% url "client:view-shops" %}" class="btn light-blue waves-light waves-effect">Back</a>
        <a href="#requestModal" class="btn green waves-light waves-effect modal-trigger request-button">Request</a>
    </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
  var transactionUrl = "{% url "client:create-transaction" %}";
</script>
<script src="{% static "client/js/order.js" %}"></script>
{% endblock %}
